import { Record } from "ts-toolbelt";

interface BuildCommand {
    command: string;
    output?: string;
}

interface EnvVariables {
    [key: string]: string | undefined;
}

interface HeaderRule {
    source: string;
    headers: Array<{ key: string; value: string }>;
}

interface CacheStrategy {
    [urlPattern: string]: { regex: boolean; immutable: boolean };
}

interface FrameworkSettings {
    vercel?: Record<string, any>;
    netlify?: Record<string, any>;
}

export interface DeployConfig {
    build: BuildCommand;
    env: EnvVariables;
    headers: Array<HeaderRule>;
    cacheStrategies: CacheStrategy;
    frameworkSettings: FrameworkSettings;
}

export const deployConfig: DeployConfig = {
    build: {
        command: "next build",
        output: ".next"
    },
    env: {
        NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL,
        DATABASE_URL: process.env.DATABASE_URL
    },
    headers: [
        {
            source: "/(.*)",
            headers: [
                { key: "Strict-Transport-Security", value: "max-age=31536000; includeSubDomains; preload" },
                { key: "X-Frame-Options", value: "DENY" },
                { key: "X-XSS-Protection", value: "1; mode=block" }
            ]
        }
    ],
    cacheStrategies: {
        "/static/(.*)": { regex: true, immutable: true },
        "/api/(.*)": { regex: true, immutable: false }
    },
    frameworkSettings: {
        vercel: {
            buildCommand: "next build",
            startCommand: "next start"
        },
        netlify: {
            buildContext: "production",
            functions: ".next/serverless-functions"
        }
    }
};

import { Record } from "ts-toolbelt";

interface BuildCommand {
    command: string;
    output?: string;
}

interface EnvVariables {
    [key: string]: string | undefined;
}

interface HeaderRule {
    source: string;
    headers: Array<{ key: string; value: string }>;
}

interface CacheStrategy {
    [urlPattern: string]: { regex: boolean; immutable: boolean };
}

interface FrameworkSettings {
    vercel?: Record<string, any>;
    netlify?: Record<string, any>;
}

export interface DeployConfig {
    build: BuildCommand;
    env: EnvVariables;
    headers: Array<HeaderRule>;
    cacheStrategies: CacheStrategy;
    frameworkSettings: FrameworkSettings;
}

export const deployConfig: DeployConfig = {
    build: {
        command: "next build",
        output: ".next"
    },
    env: {
        NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL,
        DATABASE_URL: process.env.DATABASE_URL
    },
    headers: [
        {
            source: "/(.*)",
            headers: [
                { key: "Strict-Transport-Security", value: "max-age=31536000; includeSubDomains; preload" },
                { key: "X-Frame-Options", value: "DENY" },
                { key: "X-XSS-Protection", value: "1; mode=block" }
            ]
        }
    ],
    cacheStrategies: {
        "/static/(.*)": { regex: true, immutable: true },
        "/api/(.*)": { regex: true, immutable: false }
    },
    frameworkSettings: {
        vercel: {
            buildCommand: "next build",
            startCommand: "next start"
        },
        netlify: {
            buildContext: "production",
            functions: ".next/serverless-functions"
        }
    }
};